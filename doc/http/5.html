<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTP/1.x 的缺陷 | 周非凡个人博客</title>
    <meta name="description" content="Vue 驱动的静态网站生成器">
    
    
    <link rel="preload" href="/assets/css/0.styles.d01e3fed.css" as="style"><link rel="preload" href="/assets/js/app.c9da9db2.js" as="script"><link rel="preload" href="/assets/js/2.febc0262.js" as="script"><link rel="preload" href="/assets/js/16.09fbb166.js" as="script"><link rel="prefetch" href="/assets/js/10.0253064e.js"><link rel="prefetch" href="/assets/js/11.175002a3.js"><link rel="prefetch" href="/assets/js/12.c9c2623b.js"><link rel="prefetch" href="/assets/js/13.a252b052.js"><link rel="prefetch" href="/assets/js/14.6a53dc1e.js"><link rel="prefetch" href="/assets/js/15.84088994.js"><link rel="prefetch" href="/assets/js/17.38b70eaf.js"><link rel="prefetch" href="/assets/js/18.24a31878.js"><link rel="prefetch" href="/assets/js/19.e58abf47.js"><link rel="prefetch" href="/assets/js/20.a4e1f7ec.js"><link rel="prefetch" href="/assets/js/21.520b96e8.js"><link rel="prefetch" href="/assets/js/22.8455ead8.js"><link rel="prefetch" href="/assets/js/23.012b6e4c.js"><link rel="prefetch" href="/assets/js/24.90bca786.js"><link rel="prefetch" href="/assets/js/25.0b9867c9.js"><link rel="prefetch" href="/assets/js/26.5835b50d.js"><link rel="prefetch" href="/assets/js/27.90bf64b9.js"><link rel="prefetch" href="/assets/js/28.8b2856a2.js"><link rel="prefetch" href="/assets/js/29.4f0f0797.js"><link rel="prefetch" href="/assets/js/3.b8e8b8dc.js"><link rel="prefetch" href="/assets/js/30.ec214258.js"><link rel="prefetch" href="/assets/js/31.19d008c9.js"><link rel="prefetch" href="/assets/js/32.e2e7fb69.js"><link rel="prefetch" href="/assets/js/33.e7250e7c.js"><link rel="prefetch" href="/assets/js/34.6af80751.js"><link rel="prefetch" href="/assets/js/35.8c6fd912.js"><link rel="prefetch" href="/assets/js/36.abacb260.js"><link rel="prefetch" href="/assets/js/37.872fafd6.js"><link rel="prefetch" href="/assets/js/38.c11a6237.js"><link rel="prefetch" href="/assets/js/39.0251e2ab.js"><link rel="prefetch" href="/assets/js/4.a97bd63a.js"><link rel="prefetch" href="/assets/js/40.490030c9.js"><link rel="prefetch" href="/assets/js/41.ae009df1.js"><link rel="prefetch" href="/assets/js/42.733a49d6.js"><link rel="prefetch" href="/assets/js/43.6b0719ec.js"><link rel="prefetch" href="/assets/js/44.8abd3659.js"><link rel="prefetch" href="/assets/js/45.7e9da5d6.js"><link rel="prefetch" href="/assets/js/46.69831b02.js"><link rel="prefetch" href="/assets/js/47.0187e2c6.js"><link rel="prefetch" href="/assets/js/48.d573af72.js"><link rel="prefetch" href="/assets/js/49.c0de9630.js"><link rel="prefetch" href="/assets/js/5.9f3cace6.js"><link rel="prefetch" href="/assets/js/50.dd93629a.js"><link rel="prefetch" href="/assets/js/51.0de94388.js"><link rel="prefetch" href="/assets/js/52.f40156a5.js"><link rel="prefetch" href="/assets/js/53.cd0087a3.js"><link rel="prefetch" href="/assets/js/54.dc27779e.js"><link rel="prefetch" href="/assets/js/55.e83361b5.js"><link rel="prefetch" href="/assets/js/56.e98fbba1.js"><link rel="prefetch" href="/assets/js/57.29f5154b.js"><link rel="prefetch" href="/assets/js/58.2a266b80.js"><link rel="prefetch" href="/assets/js/59.a0a6d426.js"><link rel="prefetch" href="/assets/js/6.ea94c1bd.js"><link rel="prefetch" href="/assets/js/60.431c1ff3.js"><link rel="prefetch" href="/assets/js/61.f3c25606.js"><link rel="prefetch" href="/assets/js/62.df795bbf.js"><link rel="prefetch" href="/assets/js/7.954bbdf7.js"><link rel="prefetch" href="/assets/js/8.5ac09073.js"><link rel="prefetch" href="/assets/js/9.1c3b9112.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d01e3fed.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-navbar"><!----> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS 专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/css/1.html" class="sidebar-link">css 常用知识点</a></li><li><a href="/doc/css/2.html" class="sidebar-link">清除浮动</a></li><li><a href="/doc/css/3.html" class="sidebar-link">三大经典问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTML 专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/html/1.html" class="sidebar-link">浏览器解析流程</a></li><li><a href="/doc/html/2.html" class="sidebar-link">viewport原理</a></li><li><a href="/doc/html/3.html" class="sidebar-link">meta标签</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JS 专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/js/1-1.html" class="sidebar-link">堆栈调用（上篇）</a></li><li><a href="/doc/js/1-2.html" class="sidebar-link">堆栈调用（下篇）</a></li><li><a href="/doc/js/2.html" class="sidebar-link">作用域与闭包</a></li><li><a href="/doc/js/3.html" class="sidebar-link">this绑定解析</a></li><li><a href="/doc/js/4-1.html" class="sidebar-link">call、apply原理与使用场景</a></li><li><a href="/doc/js/4-2.html" class="sidebar-link">bind 的原理与使用场景</a></li><li><a href="/doc/js/5-1.html" class="sidebar-link">浅拷贝概念以及实现原理</a></li><li><a href="/doc/js/5-2.html" class="sidebar-link">深拷贝概念以及实现原理</a></li><li><a href="/doc/js/6-1.html" class="sidebar-link">原型与继承之基本概念</a></li><li><a href="/doc/js/6-2.html" class="sidebar-link">原型与继承之（6种继承方案）</a></li><li><a href="/doc/js/7.html" class="sidebar-link">事件机制</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工具函数 专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/utils/1.html" class="sidebar-link">常见的JS方法</a></li><li><a href="/doc/utils/2.html" class="sidebar-link">常见的正则表达式</a></li><li><a href="/doc/utils/3.html" class="sidebar-link">常用的时间处理方法</a></li><li><a href="/doc/utils/4.html" class="sidebar-link">常用的金额处理方法</a></li><li><a href="/doc/utils/5.html" class="sidebar-link">继承和原型链demo</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>HTTP 专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/http/1.html" class="sidebar-link">常见的14种响应状态码</a></li><li><a href="/doc/http/2.html" class="sidebar-link">Http首部字段</a></li><li><a href="/doc/http/3.html" class="sidebar-link">Https介绍</a></li><li><a href="/doc/http/4.html" class="sidebar-link">Web的攻击技术</a></li><li><a href="/doc/http/5.html" class="active sidebar-link">Http 发展历史</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue 专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/vue/1.html" class="sidebar-link">Vue 双向绑定的原理</a></li><li><a href="/doc/vue/2.html" class="sidebar-link">Vue 踩坑总结</a></li><li><a href="/doc/vue/3.html" class="sidebar-link">Vue 生命周期详解</a></li><li><a href="/doc/vue/4.html" class="sidebar-link">Vuex 基本用法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Node 专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/node/1.html" class="sidebar-link">用node撸一个前端自动化发布工具</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>项目总结</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/project/1.html" class="sidebar-link">H5项目总结</a></li><li><a href="/doc/project/2.html" class="sidebar-link">首页优化项目总结</a></li><li><a href="/doc/project/3.html" class="sidebar-link">vue 输入限制</a></li><li><a href="/doc/project/4.html" class="sidebar-link">搜车库项目总结</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="http-1-x-的缺陷"><a href="#http-1-x-的缺陷" aria-hidden="true" class="header-anchor">#</a> HTTP/1.x 的缺陷</h3> <ul><li>链接无法复用，每次启动 TCP 链接时都要经历三次握手</li> <li>HTTP/1.1虽然加入 keep-alive 可以复用一部分连接，但域名分片等情况下仍然需要建立多个connection。 且 keep-alive 如果长时间存在会耗费资源，给服务器带来性能压力。因此 keep-alive 需要及时释放掉。</li> <li>最大请求数，浏览器限制了同域名下 http 请求的最大次数，因此超过这个数量都会进入等待队列，一旦对头阻塞，后面的请求都要等待。</li> <li>HTTP 1.1：尝试使用 pipeling 来解决，即浏览器可以一次性发出多个请求（同个域名，同一条 TCP 链接)(解决了队头阻塞的问题)，但是它要求请求返回还是按序的，因此还是有等待的问题。</li></ul> <h3 id="http-2-的改进"><a href="#http-2-的改进" aria-hidden="true" class="header-anchor">#</a> HTTP/2 的改进</h3> <ul><li>采用二进制传输： HTTP/2 采用二进制格式传输数据，而非 HTTP 1.x 的文本格式，解析更加高效。引入帧和流的概念，帧是最小的单位，每个帧上头标识所属的流。流是链接中的一个虚拟通道。</li> <li>多路复用：解决了浏览器限制同一个域名下的请求数量的问题。只发起一个TCP链接，数据流以消息的形式发送，消息又有多个帧组成，因为帧首部的流标识可以重新组装数据，因此帧之间可以乱序发送。当然也就可以并行交错的发送多个请求或响应，他们之间互不干扰，因此解决等待阻塞的问题。</li> <li>首部压缩： 因为原来 HTTP 1.x 发送请求的同时可能会在首部携带上一些字段以及cookies,如果这个数据很大且重复。那么每次传输时就会造成资源浪费。因此 http2 采用了首部压缩的策略，在客户端与服务端同时存储一份首部字段表，每次传输时只携带新增的字段或者更新的字段，同时对端进行相应的同步。</li> <li>服务端推送：也叫 cache push,  某些必须资源提前推送给客户端，减少请求的延迟时间。当然在浏览器兼容的情况下你也可以使用 prefetch。主动推送也遵守同源策略，服务器不能随便将第三方资源推送给客户端，而必须是经过双方确认才行。</li></ul> <h3 id="http-3-新特性"><a href="#http-3-新特性" aria-hidden="true" class="header-anchor">#</a> HTTP/3 新特性</h3> <h4 id="_1、改进之处"><a href="#_1、改进之处" aria-hidden="true" class="header-anchor">#</a> 1、改进之处</h4> <p>虽然HTTP2 引入了多路复用技术，一个域名下只需使用一个TCP连接，极大的提升了效率。但是如果传输存在丢包的情况，那么整个 TCP 都要开始等待重传，也就导致了后面的所有数据都被阻塞了，性能反而不如开启多个 TCP 链接的 HTTP1.X。然而UDP 没有丢包重传的问题，因此基于UDP诞生了 QUIC 协议，并且使用在了 HTTP/3 上。</p> <h4 id="_2、-quic-协议"><a href="#_2、-quic-协议" aria-hidden="true" class="header-anchor">#</a> 2、 QUIC 协议</h4> <ul><li>支持多路复用，同一条 QUIC连接上可以创建多个stream，来发送多个HTTP请求，但是 QUIC 是基于 UDP 的，一个连接上的多个stream之间没有依赖。即使出现某个 stream 丢包，其他的 stream 也可以正常传输，不存在阻塞的情况。</li> <li>QUIC 是通过 设备ID 识别一个链接（TCP 是通过 IP）， 在移动端网络环境多变的环境下优势明显，通过 ID 迅速重连。</li> <li>纠错机制，发送包的同时，也会带上一个校验包。如果出现丢包的请求，会根据校验包重新计算出丢失的数据，防止重传。当然如果丢失太多的话就没办法了。</li></ul> <h3 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h3> <ul><li>HTTP/1.x 有连接无法复用、队头阻塞、协议开销大和安全因素等多个缺陷</li> <li>HTTP/2 通过多路复用、二进制流、Header 压缩等等技术，极大地提高了性能，但是还是存在着问题的</li> <li>QUIC 基于 UDP 实现，是 HTTP/3 中的底层支撑协议，该协议基于 UDP，又取了 TCP 中的精华，实现了即快又可靠的协议</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/doc/http/4.html" class="prev">
          Web的攻击技术
        </a></span> <span class="next"><a href="/doc/vue/1.html">
          Vue 双向绑定的原理
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c9da9db2.js" defer></script><script src="/assets/js/2.febc0262.js" defer></script><script src="/assets/js/16.09fbb166.js" defer></script>
  </body>
</html>
